# MUSIC 演算法於 MIC-LDV 雙感測器系統之工程可行性報告

> **Project:** exp-tdoa-cross-correlation
> **Date:** 2026-01-28
> **Author:** Jenner
> **Status:** 初步驗證完成

---

## 1. 摘要

本報告記錄將 **MUSIC (Multiple Signal Classification)** 演算法應用於 **MIC-LDV 雙感測器系統** 的初步實驗結果。實驗目的在於評估：

1. 將 MIC 與 LDV 視為「虛擬雙元陣列」的可行性
2. MUSIC 演算法在此非典型陣列架構下能提供哪些有意義的資訊
3. 與傳統 GCC-PHAT 方法的比較

**主要發現：** MUSIC 演算法能夠成功估計 SNR（訊噪比）並產生空間頻譜，但 DoA（到達角）的物理意義需要進一步定義感測器幾何關係才能解釋。

---

## 2. 背景與動機

### 2.1 傳統 MUSIC 演算法

MUSIC 是一種 **子空間分解方法**，最初設計用於多元素天線陣列的訊號源定位。其核心思想是：

```
接收信號 = 信號子空間 + 噪聲子空間
```

透過協方差矩陣的特徵分解，可以將這兩個子空間分離，進而實現高解析度的方向估計。

### 2.2 MIC-LDV 系統的特殊性

| 特性 | 傳統麥克風陣列 | MIC-LDV 系統 |
|------|--------------|-------------|
| 感測器類型 | 同質（皆為麥克風） | 異質（麥克風 + 雷射振動計） |
| 測量物理量 | 空氣聲壓 | 聲壓 + 表面振動 |
| 幾何配置 | 已知精確間距 | 「等效間距」未定義 |
| 傳播路徑 | 直接空氣傳播 | 空氣傳播 + 結構振動 |

### 2.3 實驗目標

在不具備傳統陣列幾何定義的情況下，探索 MUSIC 演算法能提供的資訊價值。

---

## 3. 演算法實作

### 3.1 MUSIC 演算法流程

```
輸入: x_mic[n], x_ldv[n] (時域信號)
      ↓
Step 1: STFT 轉換至頻域
      X_mic(f, t), X_ldv(f, t)
      ↓
Step 2: 建立空間協方差矩陣 (每個頻率)
      x(f) = [X_mic(f), X_ldv(f)]^T
      R(f) = E[x(f) · x(f)^H]  (2×2 矩陣)
      ↓
Step 3: 特徵分解
      R = U Λ U^H
      λ₁ ≥ λ₂ (特徵值，降序排列)
      ↓
Step 4: 子空間分離
      信號子空間: u₁ (對應 λ₁)
      噪聲子空間: u₂ (對應 λ₂)
      ↓
Step 5: MUSIC 頻譜計算
      P(θ) = 1 / |a(θ)^H · U_n · U_n^H · a(θ)|
      ↓
Step 6: 峰值檢測 → DoA 估計
```

### 3.2 導引向量 (Steering Vector)

對於假設的線性雙元陣列：

```
a(θ) = [1, exp(-j·2π·f·d·sin(θ)/c)]^T
```

其中：
- `d`: 感測器間距 (本實驗使用 0.05 m 作為假設值)
- `c`: 聲速 (343 m/s)
- `θ`: 掃描角度

**重要說明：** 由於 MIC-LDV 不是傳統空間陣列，此處的 `d` 是一個「等效參數」，其物理意義需要透過校正實驗來定義。

---

## 4. 評估指標定義與結果

### 4.1 DoA (Direction of Arrival) - 到達角估計

#### 4.1.1 定義

DoA 是 MUSIC 空間頻譜 P(θ) 的峰值位置：

```
DoA = argmax_θ P(θ)
```

在傳統陣列中，DoA 代表聲源相對於陣列法線的夾角。

#### 4.1.2 本實驗的意義

**目前 DoA 不具有直接的物理幾何意義**，原因：

1. MIC 與 LDV 的「等效間距」未經校正
2. LDV 測量的是振動面（如紙杯表面），不是空氣中的某一點
3. 聲源到 MIC 與聲源到 LDV 目標面的路徑不同

**但 DoA 仍有間接意義：**
- DoA 的 **穩定性**（標準差小）表示信號品質佳
- DoA 的 **一致性**（同一錄音多窗口結果相近）表示估計可靠

#### 4.1.3 實驗結果

| 統計量 | 數值 |
|--------|------|
| Median | -16.5° |
| Mean | -14.0° |
| Std | 31.3° |
| P10 | -63.8° |
| P90 | -1.0° |

**解讀：**
- 標準差 31.3° 偏大，表示不同窗口/錄音的估計變異大
- 這符合預期，因為缺乏校正的幾何模型

---

### 4.2 τ (TDoA) - 時間差估計

#### 4.2.1 定義

從 DoA 轉換而來的等效時間差：

```
τ = d · sin(DoA) / c
```

#### 4.2.2 本實驗的意義

τ 是 DoA 的另一種表達形式，同樣受限於 `d` 參數的未校正問題。

#### 4.2.3 實驗結果

| 統計量 | 數值 |
|--------|------|
| Median | -0.041 ms |
| Mean | -0.032 ms |

**解讀：**
- τ 值約為 -0.04 ms，對應約 14 mm 的路徑差（假設 c=343 m/s）
- 此數值的物理意義需要結合實際設備配置來解釋

---

### 4.3 SNR (Eigenvalue Ratio) - 訊噪比估計

#### 4.3.1 定義

從協方差矩陣的特徵值比估計訊噪比：

```
SNR_eigen = 10 · log₁₀(λ₁/λ₂ - 1)  [dB]
```

**原理：**
- 對於單一信號源 + 白噪聲模型：
  - λ₁ ≈ σ²_signal + σ²_noise (信號 + 噪聲)
  - λ₂ ≈ σ²_noise (純噪聲)
- 因此 λ₁/λ₂ - 1 ≈ σ²_signal / σ²_noise = SNR

#### 4.3.2 本實驗的意義

**SNR_eigen 是本實驗中最有價值的指標之一**，因為：
1. 它不依賴於幾何校正
2. 直接反映 MIC 與 LDV 信號之間的相干性
3. 可用於評估錄音品質或信號檢測

#### 4.3.3 實驗結果

| 統計量 | 數值 |
|--------|------|
| Median | 14.5 dB |
| Mean | 14.2 dB |
| Std | 4.2 dB |
| P10 | 8.1 dB |
| P90 | 17.0 dB |

**解讀：**
- 中位數 14.5 dB 表示良好的信號品質
- SNR > 10 dB 通常被認為是「可用」的信號
- 變異範圍 8-17 dB 表示不同錄音段落的品質有差異（可能是語音 vs 靜音）

---

### 4.4 Spectrum PSR - 空間頻譜峰值旁瓣比

#### 4.4.1 定義

```
PSR = P(θ_peak) / median(P(θ_sidelobe))
```

其中 sidelobe 排除峰值附近 ±10° 的區域。

#### 4.4.2 本實驗的意義

PSR 反映 MUSIC 頻譜峰值的「銳利程度」：
- **PSR 高**：峰值明顯，估計可信度高
- **PSR 低**：峰值不明顯，可能有多個競爭峰值或噪聲干擾

#### 4.4.3 實驗結果

| 統計量 | 數值 |
|--------|------|
| Median | 22.5 |
| Mean | 1264.5 |
| Std | 2467.9 |

**解讀：**
- 中位數 22.5 表示典型情況下峰值比旁瓣高約 22 倍
- 平均值遠大於中位數，表示存在少數極端高 PSR 的情況
- 這種分佈是正常的，高 PSR 通常對應高 SNR 的語音段落

---

### 4.5 與 GCC-PHAT 的比較

#### 4.5.1 GCC-PHAT 方法

GCC-PHAT 是傳統的時延估計方法：

```
R_PHAT(τ) = IFFT[ X₁(f)·X₂*(f) / |X₁(f)·X₂*(f)| ]
τ_est = argmax_τ |R_PHAT(τ)|
```

#### 4.5.2 比較結果

| 指標 | MUSIC τ | GCC-PHAT τ |
|------|---------|------------|
| Median | -0.041 ms | 0.000 ms |
| Mean | -0.032 ms | -0.145 ms |
| **Correlation** | **0.043** | - |

**解讀：**
- 兩種方法的相關性極低 (0.043)
- 這表示它們測量的是不同的現象，或者 MUSIC 的幾何模型不適用於此場景

---

## 5. 空間頻譜視覺化

### 5.1 典型頻譜

![MUSIC Spatial Spectrum](../results/music_scale_test/music_spectrum_sample.png)

### 5.2 頻譜特徵分析

觀察上圖可見：
1. **主峰** 位於約 -20° 附近
2. **次要峰值** 在其他角度也存在
3. **頻譜形狀** 不是理想的單一銳利峰值

這些特徵反映了 MIC-LDV 系統的非理想性：
- 多路徑效應（直接聲 + 反射聲）
- MIC 與 LDV 響應特性不同
- 模型假設與實際情況的偏差

---

## 6. 工程可行性評估

### 6.1 已證實可行的應用

| 應用 | 可行性 | 說明 |
|------|--------|------|
| **SNR 估計** | ✅ 高 | 特徵值比法可有效估計信號品質 |
| **信號檢測** | ✅ 高 | SNR_eigen 可用於 VAD (語音活動檢測) |
| **品質監控** | ✅ 高 | PSR 可監控估計可靠度 |

### 6.2 需要進一步工作的應用

| 應用 | 可行性 | 所需工作 |
|------|--------|----------|
| **DoA 估計** | ⚠️ 待定 | 需校正實驗定義等效間距 |
| **聲源定位** | ⚠️ 待定 | 需建立 MIC-LDV 幾何模型 |
| **與 GCC-PHAT 互補** | ⚠️ 待定 | 需研究兩者關係 |

### 6.3 不建議的應用

| 應用 | 原因 |
|------|------|
| 精確角度測量 | 2 元素解析度不足 |
| 多聲源分離 | 最多只能解析 M-1=1 個源 |
| 即時定位系統 | 計算複雜度高於 GCC-PHAT |

---

## 7. 實驗限制與假設

### 7.1 當前實驗的假設

1. **平面波假設**：聲源距離遠，波前近似平面
2. **線性陣列假設**：MIC 與 LDV 排列在一條線上
3. **單一聲源假設**：只有一個主要聲源
4. **等效間距假設**：使用 d = 0.05 m 作為假設值

### 7.2 實驗限制

1. **缺乏 ground truth**：沒有實際的聲源角度參考
2. **感測器異質性**：MIC 與 LDV 的頻率響應不同
3. **傳播路徑差異**：聲波到達 MIC 與到達 LDV 目標面的路徑不同
4. **環境未控制**：可能存在混響和背景噪聲

---

## 8. 結論與建議

### 8.1 主要結論

1. **MUSIC 演算法可以在 MIC-LDV 雙感測器系統上運行**，產生有意義的輸出

2. **SNR 估計 (eigenvalue ratio) 是最可靠的輸出**：
   - 不依賴幾何校正
   - 中位數 14.5 dB 表示良好的信號品質
   - 可用於信號品質監控和語音活動檢測

3. **DoA 估計需要謹慎解讀**：
   - 目前的數值不具有直接的物理角度意義
   - 需要校正實驗來建立等效幾何模型

4. **與 GCC-PHAT 的關係需進一步研究**：
   - 兩者相關性低，可能測量不同現象
   - GCC-PHAT 更適合直接的 TDoA 估計

### 8.2 後續建議

#### 短期（立即可執行）

- [ ] 使用 SNR_eigen 作為錄音品質指標
- [ ] 將 Spectrum PSR 納入信號可靠度評估
- [ ] 建立 SNR_eigen 與語音/靜音段落的對應關係

#### 中期（需要額外實驗）

- [ ] 設計校正實驗：在已知角度放置聲源，測量 MUSIC DoA
- [ ] 建立 MIC-LDV 等效間距的經驗公式
- [ ] 比較不同頻段的 MUSIC 表現

#### 長期（研究方向）

- [ ] 開發針對 MIC-LDV 異質陣列的改進 MUSIC 演算法
- [ ] 整合 MUSIC 與 GCC-PHAT 的互補資訊
- [ ] 探索深度學習方法學習 MIC-LDV 幾何關係

---

## 9. 附錄

### 9.1 實驗配置

```yaml
Sampling Rate: 16000 Hz
FFT Size: 1024
Hop Length: 8000 samples (500 ms)
Frequency Band: 300 - 3000 Hz
Angle Scan Range: -90° to +90°
Angle Step: 1°
Assumed Spacing: 0.05 m
Speed of Sound: 343 m/s
```

### 9.2 資料集

- **來源**: boy1_papercup 錄音集
- **配對數**: 10 pairs (scale mode)
- **總窗口數**: 56 windows

### 9.3 輸出檔案

| 檔案 | 說明 |
|------|------|
| `summary.json` | 統計摘要 |
| `detailed_results.json` | 逐窗口結果 |
| `music_spectrum_sample.png` | 頻譜視覺化 |
| `manifest.json` | 實驗配置記錄 |

### 9.4 程式碼

主要腳本: `scripts/run_music_doa.py`

```bash
python scripts/run_music_doa.py \
  --mic_root "path/to/MIC" \
  --ldv_root "path/to/LDV" \
  --out_dir "results/music_xxx" \
  --spacing_m 0.05 \
  --mode scale
```

---

## 10. 參考文獻

1. Schmidt, R. O. (1986). "Multiple emitter location and signal parameter estimation." IEEE Transactions on Antennas and Propagation.

2. Knapp, C., & Carter, G. C. (1976). "The generalized correlation method for estimation of time delay." IEEE Transactions on Acoustics, Speech, and Signal Processing.

3. Benesty, J., Chen, J., & Huang, Y. (2008). "Microphone Array Signal Processing." Springer.

---

*Report generated: 2026-01-28*
