# 0222 金屬板遮擋實驗 — GCC-PHAT 完整分析報告

> **日期**: 2026-02-22
> **實驗目的**: 驗證金屬板遮擋對 MIC-MIC GCC-PHAT 聲源定位的影響
> **分析工具**: 自製 GCC-PHAT (含拋物線插值) + pyroomacoustics `pra.tdoa()`

---

## 1. 實驗設置

### 1.1 幾何配置

```
       y(m)
       ↑
  2.0  ├──── MIC_L(-0.7, 2.0) ──────────── MIC_R(+0.7, 2.0) ────
       │              間距 d = 1.4 m
       │
       │
  0.5  ├──────────── LDV(0.0, 0.5) ──────────
       │
  0.0  ├──●──────●──────●──────●──────●──── → x(m)
          -0.8  -0.4   0.0   +0.4  +0.8
          喇叭位置 (y = 0)
```

| 參數 | 值 |
|------|------|
| 麥克風間距 | d = 1.4 m |
| 取樣率 | fs = 48,000 Hz |
| 聲速 | c = 343 m/s |
| 訊號源 | 0.1V 男孩語音 (boy speech) |
| 音量設定 | 40 (amplifier setting) |

### 1.2 遮擋裝置

- **金屬板尺寸**: 長 1.0 m × 寬 0.6 m × 厚 0.5 cm (鋼板)
- **放置方式**: 垂直擺放於喇叭與麥克風之間
- **遮擋目標**: 同時遮擋喇叭前方和麥克風前方的直達聲路徑

### 1.3 理論角度

| 喇叭位置 x | d_left (m) | d_right (m) | 理論 τ (ms) | 理論 θ (°) |
|------------|-----------|------------|------------|-----------|
| +0.8 m | 2.500 | 2.002 | +1.450 | +20.82° |
| +0.4 m | 2.285 | 2.022 | +0.759 | +10.71° |
| 0.0 m | 2.119 | 2.119 | 0.000 | 0.00° |

---

## 2. 資料集總覽

### 2.1 錄音檔案清單

| 資料集 | 路徑 | 喇叭位置 | 有無遮擋 | 備註 |
|--------|------|---------|---------|------|
| block | `block/` | 0.0 m | ✅ 有 | 基準組 |
| block-1 | `block/block-1/` | 0.0 m | ✅ 有 | 重複測量 |
| block-2 | `block/block-2/` | 0.0 m | ✅ 有 | 重複測量 |
| block-3 | `block/block-3/` | 0.0 m | ✅ 有 | 重複測量 |
| block-4 | `block/block-4/` | 0.0 m | ✅ 有 | 重複測量 |
| block-5 | `block/block-5/` | 0.0 m | ✅ 有 | 重複測量 |
| block-6 | `block/block-6/` | +0.8 m | ✅ 有 | 偏心位置 |
| block-7 | `block/block-7/` | +0.8 m | ✅ 有 | 偏心位置 |
| block-8 | `block/block-8/` | +0.4 m | ✅ 有 | 偏心位置 |
| noblock | `noblock/` | 0.0 m | ❌ 無 | 對照組 |
| noblock-1 | `noblock/1/` | +0.4 m | ❌ 無 | 對照組 |
| noblock-2 | `noblock/2/` | +0.8 m | ❌ 無 | 對照組 |

---

## 3. GCC-PHAT 演算法

### 3.1 六步驟流程

```
步驟 1: FFT                    步驟 2: 交叉頻譜
───────────────                ────────────────
 x_L(t) ──→ FFT ──→ S_L(f)    R(f) = S_L(f) × S_R*(f)
 x_R(t) ──→ FFT ──→ S_R(f)    提取兩麥克風之間的相位差

步驟 3: PHAT 白化              步驟 4: IFFT
────────────────               ──────────
 W(f) = R(f) / |R(f)|         CC(τ) = IFFT{ W(f) }
 消除振幅，只保留相位           轉回時域，得到互相關函數
 每個頻率「一人一票」

步驟 5: 尋找峰值               步驟 6: 拋物線插值
────────────────               ────────────────
 τ_peak = argmax |CC(τ)|      利用峰值及相鄰兩點
 在 ±10ms 範圍內搜尋            δ = 0.5(y₀-y₂)/(y₀-2y₁+y₂)
                               達到 ~0.001ms 精度
```

### 3.2 交叉頻譜的物理意義

```
兩個麥克風接收同一聲源，存在時間差 τ₀:
  x_R(t) ≈ x_L(t - τ₀)

FFT 後:
  S_R(f) = S_L(f) × e^{-j2πfτ₀}

交叉頻譜:
  R(f) = S_L(f) × S_R*(f) = |S_L(f)|² × e^{+j2πfτ₀}

相位部分:
  ∠R(f) = 2πf × τ₀  ← 線性相位，斜率 = τ₀

PHAT 白化後:
  W(f) = e^{+j2πfτ₀}  ← 純相位，每個頻率投票權相等

IFFT:
  CC(τ) = Σ e^{j2πf(τ₀-τ)}  → 在 τ = τ₀ 時建設性干涉
         f                      → 產生尖銳 peak
```

### 3.3 TDOA 到角度的轉換

```
θ = arcsin(τ × c / d) = arcsin(τ_ms / 1000 × 343 / 1.4)

τ > 0 → 聲音先到 RIGHT MIC → 聲源在 LEFT 側 (正角度定義)
τ < 0 → 聲音先到 LEFT MIC  → 聲源在 RIGHT 側
```

### 3.4 品質指標

| 指標 | 定義 | 參考值 |
|------|------|--------|
| **Peak** | CC(τ) 最大值 (0~1) | 越高越好 |
| **PAR** | Peak-to-Average Ratio | 越高越好 |
| **PSR** | Peak-to-Sidelobe Ratio (dB) | >20 dB 好，>30 dB 優 |

---

## 4. 實驗結果

### 4.1 全資料集結果總表

#### Fullband (無濾波)

| 資料集 | 喇叭 | 遮擋 | 理論 θ | 測量 τ (ms) | 測量 θ | 誤差 | Peak | PSR (dB) | 判定 |
|--------|------|------|--------|-----------|--------|------|------|----------|------|
| block | 0.0m | ✅ | 0.00° | -0.201 | -2.83° | -2.83° | 0.102 | 1.1 | ⚠️ |
| block-1 | 0.0m | ✅ | 0.00° | -0.336 | -4.72° | -4.72° | 0.106 | 6.7 | ⚠️ |
| block-2 | 0.0m | ✅ | 0.00° | +0.085 | +1.19° | +1.19° | 0.090 | 3.3 | ⚠️ |
| block-3 | 0.0m | ✅ | 0.00° | -0.002 | -0.03° | -0.03° | 0.091 | 4.0 | ✅ |
| block-4 | 0.0m | ✅ | 0.00° | +0.005 | +0.07° | +0.07° | 0.056 | 2.9 | ✅ |
| block-5 | 0.0m | ✅ | 0.00° | +0.580 | +8.17° | +8.17° | 0.056 | 0.7 | ❌ |
| block-6 | +0.8m | ✅ | +20.82° | +1.174 | +16.71° | -4.11° | 0.084 | 0.4 | ⚠️ |
| block-7 | +0.8m | ✅ | +20.82° | +1.410 | +20.22° | -0.60° | 0.224 | 4.7 | ✅ |
| block-8 | +0.4m | ✅ | +10.71° | +0.018 | +0.25° | -10.46° | 0.056 | 1.8 | ❌ |
| noblock | 0.0m | ❌ | 0.00° | -0.140 | -1.97° | -1.97° | 0.320 | 7.8 | ⚠️ |
| noblock-1 | +0.4m | ❌ | +10.71° | +0.591 | +8.32° | -2.39° | 0.157 | 7.7 | ⚠️ |
| noblock-2 | +0.8m | ❌ | +20.82° | +1.383 | +19.81° | -1.01° | 0.078 | 0.6 | ✅ |

#### BP 500-2000 Hz (帶通濾波)

| 資料集 | 喇叭 | 遮擋 | 理論 θ | 測量 τ (ms) | 測量 θ | 誤差 | Peak | PSR (dB) | 判定 |
|--------|------|------|--------|-----------|--------|------|------|----------|------|
| block | 0.0m | ✅ | 0.00° | +0.000 | +0.00° | +0.00° | 0.861 | 30.1 | ✅ |
| block-1 | 0.0m | ✅ | 0.00° | +0.003 | +0.04° | +0.04° | 0.807 | 29.6 | ✅ |
| block-2 | 0.0m | ✅ | 0.00° | +0.000 | +0.01° | +0.01° | 0.851 | 30.9 | ✅ |
| block-3 | 0.0m | ✅ | 0.00° | -0.004 | -0.05° | -0.05° | 0.727 | 31.5 | ✅ |
| block-4 | 0.0m | ✅ | 0.00° | -0.005 | -0.07° | -0.07° | 0.656 | 29.5 | ✅ |
| block-5 | 0.0m | ✅ | 0.00° | +0.000 | +0.01° | +0.01° | 0.888 | 33.5 | ✅ |
| block-6 | +0.8m | ✅ | +20.82° | +0.002 | +0.03° | **-20.79°** | 0.769 | 28.3 | ❌ |
| block-7 | +0.8m | ✅ | +20.82° | +0.000 | +0.01° | **-20.81°** | 0.847 | 26.5 | ❌ |
| block-8 | +0.4m | ✅ | +10.71° | +0.002 | +0.02° | **-10.69°** | 0.118 | 15.1 | ❌ |
| noblock | 0.0m | ❌ | 0.00° | +0.001 | +0.01° | +0.01° | 0.854 | 28.8 | ✅ |
| noblock-1 | +0.4m | ❌ | +10.71° | -0.000 | -0.00° | **-10.71°** | 0.879 | 30.9 | ❌ |
| noblock-2 | +0.8m | ❌ | +20.82° | +0.000 | +0.00° | **-20.81°** | 0.871 | 31.5 | ❌ |

### 4.2 結果摘要

```
                   Fullband              BP 500-2000 Hz
                   ─────────             ──────────────
  0.0m 有擋(6組):  ⚠️ 不穩定(±8°)       ✅ 全部正確 (~0°)
  0.0m 沒擋(1組):  ⚠️ 誤差 -1.97°        ✅ 正確 (~0°)
  +0.4m 沒擋:      ⚠️ 誤差 -2.39°        ❌ 鎖在 0° (誤差 -10.71°)
  +0.4m 有擋:      ❌ 誤差 -10.46°       ❌ 鎖在 0° (誤差 -10.69°)
  +0.8m 沒擋:      ✅ 誤差 -1.01°        ❌ 鎖在 0° (誤差 -20.81°)
  +0.8m 有擋(2組): ✓/⚠️ 誤差 -0.6~-4.1° ❌ 鎖在 0° (誤差 ~-20.8°)
```

**關鍵觀察**:
1. **BP 500-2000**: 只在 0.0m 正確（因為理論答案本身就是 0°）；所有偏心位置全部失敗
2. **Fullband**: 偏心位置大致可用（誤差 1~4°），但 0.0m 位置反而不穩定
3. **遮擋效果**: 對比 noblock-1 (+0.4m) vs block-8 (+0.4m)，Fullband 誤差從 -2.39° 惡化到 -10.46°

---

## 5. 問題診斷：為什麼 BP 500-2000 Hz 鎖在 0°？

### 5.1 0ms Peak 壓倒性強度

以 `noblock-1` (喇叭 +0.4m，**無遮擋**) 為例：

```
BP 500-2000 Hz 的 GCC-PHAT 曲線:

CC(τ):
 0.88 │       ▓▓
 0.80 │       ██           ← 0ms peak = 0.879 (壓倒性!)
 0.60 │       ██
 0.40 │       ██
 0.20 │       ██
 0.05 │       ██
 0.00 │▓▓▓▓▓▓████▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓  ← 正確位置 0.76ms 處
      └──┬──┬──┬──┬──┬──┬──┬──┬──┬──→     peak = 0.006 (幾乎不可見)
        -4  -2   0  +1  +2  +3  +4  τ(ms)

 0ms 比正確位置強 149.6 倍!
```

### 5.2 為什麼所有窄頻段都鎖 0ms？

對 `noblock-1` (+0.4m，無遮擋) 做細分頻段測試：

| 頻段 (Hz) | val @ 0ms | val @ correct | 0ms 強幾倍 | Peak 位置 |
|-----------|----------|--------------|-----------|----------|
| 500-1000 | 0.943 | 0.030 | 31.0× | 0ms ✗ |
| 1000-2000 | 0.209 | 0.035 | 6.0× | 0ms ✗ |
| 2000-4000 | 0.836 | 0.040 | 20.7× | 0ms ✗ |
| 4000-8000 | 0.695 | 0.074 | 9.4× | 0ms ✗ |
| 8000-16000 | 0.330 | 0.045 | 7.4× | 0ms ✗ |
| 16000-23000 | 0.480 | 0.020 | 24.5× | 0ms ✗ |

**結論**: 不是某個頻段特別差——**每一個窄頻段的 0ms peak 都遠強於正確位置**。

### 5.3 根本原因：低 SNR + 室內殘響

```
問題鏈:
  ┌─────────────────────────────────────────────────┐
  │ 0.1V 男孩語音 → 喇叭功率極低                      │
  │           ↓                                      │
  │ 距離 2m → 直達聲到達麥克風時已非常微弱              │
  │           ↓                                      │
  │ 室內殘響(牆壁、天花板、地板反射) 能量 >> 直達聲     │
  │           ↓                                      │
  │ 殘響來自四面八方 → 等效為「中心擴散源」             │
  │           ↓                                      │
  │ 左右麥克風接收到的殘響幾乎同步 → τ ≈ 0ms           │
  │           ↓                                      │
  │ GCC-PHAT 的 0ms peak 主導 → 定位結果鎖在 0°       │
  └─────────────────────────────────────────────────┘
```

在窄頻段（如 500-2000 Hz）中，少量頻率 bin 投票，殘響的 0ms 相位高度一致，輕易形成極尖銳的 peak。

---

## 6. 核心發現：為什麼 Fullband 不鎖在 0°？

### 6.1 頻率投票機制

GCC-PHAT 經 PHAT 白化後，本質上是**頻率投票**:
- 每個頻率 bin 根據自己觀察到的相位差，投票給它認為的延遲 τ
- PHAT 白化確保每個 bin 票權相等 (振幅歸一化)
- IFFT 相當於把所有票加總 → peak 出現在得票最多的 τ

### 6.2 各頻段投票分析 (noblock-1, +0.4m)

```
投票標準: 若頻率 bin 的相位誤差 < π/4，視為投票支持該延遲

┌───────────────────────────────────────────────────────────┐
│ 頻段 (Hz)     │ 投「correct」 │ 投「0ms」  │  誰贏？      │
│───────────────┼──────────────┼───────────┼─────────────  │
│   200-500     │    55.1%     │   10.4%   │ correct 大勝! │ ⭐
│   500-1000    │    38.9%     │   15.6%   │ correct 勝    │ ⭐
│  4000-8000    │    43.7%     │   17.4%   │ correct 勝    │ ⭐
│───────────────┼──────────────┼───────────┼─────────────  │
│  1000-2000    │    23.0%     │   37.9%   │ 0ms 勝        │
│  2000-4000    │     8.3%     │   22.5%   │ 0ms 勝        │
│  8000-16000   │    23.9%     │   28.1%   │ 0ms 勝        │
│ 16000-23000   │    24.3%     │   31.2%   │ 0ms 勝        │
│───────────────┼──────────────┼───────────┼─────────────  │
│ 全頻段合計     │    26.8%     │   26.7%   │ 幾乎平手!     │
└───────────────────────────────────────────────────────────┘
```

### 6.3 窄頻段 vs Fullband 的 GCC-PHAT 值

```
窄頻段 (500-1000 Hz):        Fullband (20-23000 Hz):
──────────────────           ─────────────────────
CC(τ):                       CC(τ):

0.94│    ▓▓                  0.16│           ▄▄
0.80│    ██                  0.12│          ████
0.60│    ██                  0.08│   ▄▄    ██████  ▄▄
0.40│    ██                  0.04│  ████  ████████████  ▄▄    ▄▄
0.20│    ██                  0.00│▓▓████▓████████████████████▓████▓
0.00│▓▓▓████▓▓▓▓▓▓▓▓▓       └──┬──┬──┬──┬──┬──┬──┬──┬──→ τ(ms)
    └──┬──┬──┬──→ τ(ms)        -2  -1  0  +1  +2  +3  +4
      -1   0  +1                          ↑
           ↑                         +0.583ms ← 接近正確!
      0ms 壓倒性!
                              0ms 處才 0.047 (大幅下降!)
val@0ms   = 0.943             val@0ms     = 0.047
val@corr  = 0.030             val@correct = 0.043
比值 = 31.0×                  peak        = 0.157 @ +0.583ms
```

### 6.4 關鍵機制：跨頻段相位抵消

```
為什麼 Fullband 的 0ms peak 從 0.943 降到 0.047？

┌──────────────────────────────────────────────────────────────────┐
│                                                                  │
│  窄頻段中，投 0ms 的 bin 相位高度一致:                              │
│                                                                  │
│    500Hz:  ∠R = +0.02 rad  ─┐                                   │
│    600Hz:  ∠R = +0.01 rad   ├→ 相位幾乎同向 → 建設性干涉          │
│    700Hz:  ∠R = -0.01 rad  ─┘   → 0ms peak 超尖銳 (0.943)       │
│                                                                  │
│  但跨頻段時，不同頻段投 0ms 的相位不同步:                           │
│                                                                  │
│    500-1000 Hz 的殘響相位 → 某個方向                               │
│    1000-2000 Hz 的殘響相位 → 另一個方向                            │
│    4000-8000 Hz 的殘響相位 → 又一個方向                            │
│              ↓                                                   │
│    加總後互相抵消 → 0ms peak 大幅削弱 (0.047)                      │
│                                                                  │
│  而直達聲不論頻率，相位都指向同一個 τ:                               │
│                                                                  │
│    500Hz:   ∠R = 2π×500×τ₀   ─┐                                 │
│    5000Hz:  ∠R = 2π×5000×τ₀   ├→ 全部指向 τ₀ → 建設性干涉        │
│    15000Hz: ∠R = 2π×15000×τ₀ ─┘   → 正確位置累積突出              │
│                                                                  │
└──────────────────────────────────────────────────────────────────┘
```

### 6.5 一句話總結

> **每個窄頻段裡，室內殘響在 τ=0ms 的能量都壓過直達聲。但在 Fullband 加總時，支持 0ms 的不同頻段之間「相位不同步」，互相抵消；而直達聲不論頻率都指向同一個 τ₀，跨頻段累積後突出成最高 peak。這就是 PHAT 白化 + 全頻段的核心優勢。**

---

## 7. 有擋 vs 沒擋的比較

### 7.1 +0.4m 位置比較

| | noblock-1 (沒擋) | block-8 (有擋) | 差異 |
|---|---|---|---|
| Fullband θ | +8.32° | +0.25° | 遮擋使誤差從 -2.39° 惡化到 -10.46° |
| Fullband Peak | 0.157 | 0.056 | 遮擋使 peak 降低 64% |
| BP 500-2000 θ | -0.00° | +0.02° | 兩者都鎖 0° (都失敗) |

### 7.2 +0.8m 位置比較

| | noblock-2 (沒擋) | block-7 (有擋) | block-6 (有擋) |
|---|---|---|---|
| Fullband θ | +19.81° | +20.22° | +16.71° |
| Fullband 誤差 | -1.01° | -0.60° | -4.11° |
| Fullband Peak | 0.078 | 0.224 | 0.084 |
| BP 500-2000 θ | +0.00° | +0.01° | +0.03° |
| BP 500-2000 | ❌ 鎖 0° | ❌ 鎖 0° | ❌ 鎖 0° |

### 7.3 遮擋效果結論

| 條件 | Fullband | BP 500-2000 |
|------|----------|-------------|
| **遮擋對 0.0m 的影響** | 無顯著影響 (對稱位置) | 無影響 (本來就是 0°) |
| **遮擋對 +0.4m 的影響** | ⚠️ 嚴重惡化 (8.32° → 0.25°) | 無影響 (本來就鎖 0°) |
| **遮擋對 +0.8m 的影響** | 輕微影響 (19.81° → 16~20°) | 無影響 (本來就鎖 0°) |

---

## 8. 金屬板遮擋的物理機制

### 8.1 聲學遮蔽分析

5mm 鋼板的穿透損失 (Mass Law):

```
TL(f) = 20 × log₁₀(m × f) - 47.2 dB

其中 m = ρ × t = 7800 kg/m³ × 0.005 m = 39 kg/m²

TL(500 Hz)  = 20×log₁₀(39×500) - 47.2  ≈ 38.6 dB  (穿透率 0.014%)
TL(1000 Hz) = 20×log₁₀(39×1000) - 47.2 ≈ 44.6 dB  (穿透率 0.003%)
TL(2000 Hz) = 20×log₁₀(39×2000) - 47.2 ≈ 50.6 dB  (穿透率 0.001%)
```

**結論**: 聲音幾乎不可能穿透 5mm 鋼板（穿透率 < 0.01%）。板振動輻射不是主因。

### 8.2 實際機制：繞射 + 邊緣效應

```
俯視圖 (有擋，喇叭在 +0.8m):

         MIC_L(-0.7)        MIC_R(+0.7)
            ○                   ○
            │ ╲               ╱ │
            │   ╲           ╱   │
            │    ╲         ╱    │
            │     ╲       ╱     │
            │   ┌──┤=====├──┐  │  ← 金屬板 (x ≈ 0 附近)
            │   │  │BLOCK│  │  │
            │   └──┤=====├──┘  │
            │     ↑       ↑     │
            │  邊緣繞射  邊緣繞射 │
            │     ╲       ╱     │
            │      ╲     ╱      │
            │       ╲   ╱       │
            ●────────●──────────│
          -0.8      0.0       +0.8
                              喇叭

  直達聲: 被金屬板完全阻擋 (35-50 dB 損失)
  繞射聲: 從板的左右邊緣繞過，等效聲源在 x ≈ 0 附近
         → 到左右麥克風的距離幾乎相等
         → TDOA ≈ 0ms
         → GCC-PHAT 定位到 0°
```

### 8.3 為什麼 0.0m 位置遮擋無效？

```
喇叭在 0.0m (正中央):

  即使沒有遮擋: TDOA 理論值就是 0ms (對稱幾何)
  有遮擋之後:   繞射聲源也在 x ≈ 0 附近 → 仍然 TDOA ≈ 0ms

  所以無論有無遮擋，結果都是正確的 0°
  → 無法用 0.0m 位置來驗證遮擋效果!
```

---

## 9. 頻率投票的跨資料集驗證

### 9.1 noblock-1 (沒擋, +0.4m)

| 頻段 | 投 correct | 投 0ms | 勝者 |
|------|-----------|--------|------|
| 200-500 Hz | 55.1% | 10.4% | **correct** |
| 500-1000 Hz | 38.9% | 15.6% | **correct** |
| 1000-2000 Hz | 23.0% | 37.9% | 0ms |
| 2000-4000 Hz | 8.3% | 22.5% | 0ms |
| 4000-8000 Hz | 43.7% | 17.4% | **correct** |
| 8000-16000 Hz | 23.9% | 28.1% | 0ms |
| 16000-23000 Hz | 24.3% | 31.2% | 0ms |
| **全頻段** | **26.8%** | **26.7%** | **幾乎平手 → Fullband peak 在 +0.583ms** |

### 9.2 block-7 (有擋, +0.8m)

| 頻段 | 投 correct | 投 0ms | 勝者 |
|------|-----------|--------|------|
| 200-500 Hz | 26.7% | 25.9% | **correct** |
| 500-1000 Hz | 26.9% | 20.9% | **correct** |
| 1000-2000 Hz | 26.9% | 18.7% | **correct** |
| 2000-4000 Hz | 46.1% | 22.1% | **correct** |
| 4000-8000 Hz | 17.2% | 28.0% | 0ms |
| 8000-16000 Hz | 16.1% | 24.7% | 0ms |
| 16000-23000 Hz | 25.4% | 31.1% | 0ms |
| **全頻段** | **22.8%** | **26.8%** | **0ms 略勝 → 但 Fullband peak 在 +1.417ms ✅** |

### 9.3 noblock-2 (沒擋, +0.8m)

| 頻段 | 投 correct | 投 0ms | 勝者 |
|------|-----------|--------|------|
| 200-500 Hz | 34.5% | 23.1% | **correct** |
| 500-1000 Hz | 32.6% | 32.5% | **correct** |
| 1000-2000 Hz | 29.6% | 21.5% | **correct** |
| 2000-4000 Hz | 31.3% | 31.1% | **correct** |
| 4000-8000 Hz | 20.7% | 20.1% | **correct** |
| 8000-16000 Hz | 22.9% | 23.8% | 0ms |
| 16000-23000 Hz | 24.9% | 31.9% | 0ms |
| **全頻段** | **24.6%** | **26.5%** | **0ms 略勝 → 但 Fullband peak 在 +1.375ms ✅** |

### 9.4 規律總結

```
低頻 (< 4 kHz):  通常投票給 correct → 直達聲的低頻分量保留較好
高頻 (> 8 kHz):  通常投票給 0ms     → 高頻更容易被反射/散射主導

但投票比例差異很小 (26% vs 27%)
→ Fullband 的優勢來自「跨頻段相位抵消」效應，而非單純票數

即使 0ms 在 bin 數上微幅領先，
正確延遲的相位一致性更高 → IFFT 後 peak 更尖銳
```

---

## 10. 總結與問題清單

### 10.1 已驗證結論

1. **BP 500-2000 Hz 在所有偏心位置完全失敗** (鎖在 0°)
   - 無論有無遮擋，0.1V boy speech 在 2m 距離的 SNR 不足
   - 室內殘響在窄頻段中完全主導 GCC-PHAT 的 peak

2. **Fullband 透過跨頻段相位抵消勉強恢復定位**
   - 殘響的 0ms 貢獻在跨頻段加總時相位不同步 → 互相抵消
   - 直達聲的相位跨所有頻率一致 → 累積後突出
   - 但 peak 值很低 (0.05~0.22)，可靠性有限

3. **金屬板遮擋使 Fullband 性能進一步退化**
   - +0.4m: 誤差從 -2.39° 惡化到 -10.46° (遮擋效果顯著)
   - +0.8m: 誤差從 -1.01° 惡化到 -0.60°~-4.11° (遮擋效果較小)
   - 機制: 直達聲被阻擋 → 只剩繞射 (等效源在 x≈0) + 反射

4. **0.0m 位置無法驗證遮擋效果** (對稱幾何)

### 10.2 目前問題

| # | 問題 | 嚴重度 |
|---|------|--------|
| 1 | BP 500-2000 Hz 在低 SNR 環境下完全不可用 | 🔴 嚴重 |
| 2 | Fullband 結果不穩定 (同條件下誤差範圍大) | 🟡 中等 |
| 3 | 遮擋使直達聲路徑消失，GCC-PHAT 只能依賴繞射/反射 | 🔴 嚴重 |
| 4 | 0.1V boy speech 音量過低，直達聲殘響比 (DRR) 不足 | 🟡 中等 |

### 10.3 LDV 的潛在角色

LDV 測量的是雷射光斑處固體表面的振動速度，不直接受空氣中殘響影響。若金屬板能有效阻擋 MIC-MIC 的直達聲，而 LDV 能透過板振動或其他路徑捕獲到與聲源位置相關的延遲資訊，則 LDV 可能在遮擋場景下提供 MIC 無法獲取的定位線索。此為後續實驗方向。
